<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Triggering Algorithm - Arterial BP Triggering</title>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script>

  <style>
    body {font-size: 90%;}
    pre, code {font-size: 100%;}
    h3, h4, h5, h6 {color: #2980b9; font-weight: 300}
  </style> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Arterial BP Triggering</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
        <span>Instructions</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../instructions/user_manual">User Manual</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../instructions/guidelines-for-adapting-to-new-instrument">Guidelines for using a Different Pressure Measurement System</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../instructions/reflash-the-microcontroller">Reflashing the Microcontroller</a>
                    
                </li>
            
        

    
        
        <span>System Design</span>
            
                <li class="toctree-l1 ">
                    <a class="" href=".">System Block Diagram</a>
                    
                </li>
            
                <li class="toctree-l1 current">
                    <a class="current" href=".">Triggering Algorithm</a>
                    
                        <ul>
                        
                            <li class="toctree-l2"><a href="#blood-pressure-signal-preprocessing">Blood Pressure Signal Preprocessing</a></li>
                            
                        
                            <li class="toctree-l2"><a href="#testing">Testing</a></li>
                            
                        
                            <li class="toctree-l2"><a href="#blood-pressure-peak-detection">Blood Pressure Peak Detection</a></li>
                            
                        
                        </ul>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../adaptive-gain-adjustment">Variable Gain Amplifier</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../gui-design">Monitoring Tool</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../pcb-design">PCB</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../testing-australian-data">Validation</a>
                    
                </li>
            
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="../.."></a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    <li>Triggering Algorithm</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/JoshBradshaw/Arterial-BP-MRI-Triggering-Unit" class="icon icon-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <h2 id="blood-pressure-signal-preprocessing">Blood Pressure Signal Preprocessing</h2>
<p>The top plot in Figure xx shows an arterial blood pressure waveform which was measured invasively in a fetal lamb. Notice that the notice after the main pressure peak, there is a second reflection peak, which results from closing of the aortic value. </p>
<p>This waveform is relatively noisy, and the peak is not particularly easy to identify. For this reason, it is necessary to apply a filtering algorithm to simplify peak detection. First a first order low pass filter with a cut-off frequency of 25Hz is applied, to smooth the small spikes in the pressure waveform, as shown in the figure below. The first order low pass filter’s equation is given below.</p>
<p><img alt="alt text" src="../..//images/low-pass-filter-equation.png" title="low pass filter" /></p>
<p>Next the slow sum function is applied. The slope sum function is defined as:</p>
<p><img alt="alt text" src="../..//images/slope_sum_function.png" title="low pass filter" /></p>
<p>Where the optimal value of the windowing constant k is the number of samples in the rising edge of the signal [2]. For the fetal pig application, we chose k=15, based upon visual inspection of pre-existing fetal lamb blood pressure recordings, which are very similar to fetal pigs in terms of blood pressure and heart rate. 
The plot below illustrates shows a plot of a fetal lamb’s blood pressure, and the corresponding slope filtered output for that blood pressure waveform. </p>
<p><img alt="alt text" src="../..//images/blood-pressure-filtering.png" title="low pass filter" /></p>
<p>Notice that the low pass filter removes the high frequency ridges from the blood pressure waveform, leaving only the low frequency content that corresponds to the expansion and contractions of the hearts ventricles. </p>
<p>The slope sum function improves the signal by establishing a consistent baseline of zero, eliminating the effects of DC drifts in the measurement instrument. The slope sum function also sharpens the peaks, which makes the problem of automatic peak detection far less ambiguous.</p>
<h2 id="testing">Testing</h2>
<p>The algorithm was evaluated against the following test blood pressure waveforms.</p>
<ol>
<li><a href="http://physionet.cps.unizar.es/physiobank/database/slpdb/slpdb.shtml">MIT Database of non-invasive blood pressure recordings</a></li>
<li>Pulse oximeter of my own heart, taken while serving as test subject for a maternal health sequence.</li>
<li>Invasive fetal lamb blood pressure recordings, taken by an Australian research group.</li>
</ol>
<h2 id="blood-pressure-peak-detection">Blood Pressure Peak Detection</h2>
<p>The blood pressure pulse detection algorithm is a state machine. The high level overview of the algorithm is given by the flow chart below.</p>
<p><img alt="alt text" src="../..//images/blood-pressure-peak-detect.png" title="low pass filter" /></p>
<p>To ensure that the peak detector only triggers on unique blood pressure pulses, a refractory period is applied between peaks, and the algorithm does not begin peak detection until the rising edge is detected and the signal magnitude is greater than the peak threshold. The peak threshold is calculated as ½ of the average of the last five peaks.</p>
<p>The point roll algorithm for peak detection works by comparing the value of the current sample to the value (u[n]) of the fourth more recent sample (u[n-4]). This operation is similar to the backwards approximation of the first derivative. A peak is detected when u[n-4] &gt; u[n], which corresponds to a slow of zero. </p>

            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../adaptive-gain-adjustment" class="btn btn-neutral float-right" title="Variable Gain Amplifier"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="." class="btn btn-neutral" title="System Block Diagram"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
            <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
        
      <span><a href="." style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="../adaptive-gain-adjustment" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>
</body>
</html>